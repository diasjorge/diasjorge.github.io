<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-15098892-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-15098892-1');
</script>

    <title>Monthly archives for Jekyll</title>
    <meta charset="utf-8"/>
    <meta name="description" content="Mr. Dias. Software Development Thoughts"/>
    <meta name="author" content="Jorge Dias"/>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

    <link rel="stylesheet" href="/stylesheets/main.css"/>

    <!--[if lt IE 9]>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6/html5shiv.min.js"></script>
        <![endif]-->

    <link rel="alternate" type="application/rss+xml" title="Articles RSS" href="https://feeds2.feedburner.com/mrdias" />
  </head>
  <body>
    <div class="container">
      <div id="header" class="sixteen columns">
        <div id="toplinks">
          <a href="https://github.com/diasjorge">
            <img width="24" height="24" src="/images/github_24.png"/>
          </a>
          <a href="https://twitter.com/dias_jorge">
            <img width="24" height="24" src="/images/twitter_24.png"/>
          </a>
          <a href="https://linkedin.com/in/jorgediasmartinez/en">
            <img width="24" height="24" src="/images/linkedin_24.png"/>
          </a>
        </div>
        <h1><a href="/">Mr. Dias</a></h1>
        <h4>Software Development Thoughts</h4>
      </div>
      <div id="content" class="two-thirds column">
        <div class="article">
  <div class="wrapper">
    <div class="header">
      <h2>
        Monthly archives for Jekyll
      </h2>
    </div>
    <div class="content">
      <p>Recently I moved my blog to <a href="http://jekyllrb.com/">Jekyll</a>, while being able to write stuff directly in my favorite editor EMACS, there was some functionality that I was missing from my previous custom blog engine, such as archives. Looking at how I could achieve this, I found <a href="http://rfelix.com">Raoul Felix</a> approach to the problem. Instead of patching jekyll, he wrote a small library that wraps around it, called <a href="http://github.com/rfelix/jekyll_ext">jekyll_ext</a>. Using it was really easy, and based on some of the extensions he created, I was able to provide this functionality in my site.</p>

<p>Although I had archives generated for me, I was still missing a way to display this information on my site, so I decided to create my own extension.<!-- -**-END-**- --></p>

<p>I added the following code inside _extensions/archive_iterator.rb, which will provide me with an array of all the months when I’ve written posts:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span></span><span class="k">module</span> <span class="nn">Jekyll</span>
  <span class="no">AOP</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="no">Site</span><span class="p">,</span> <span class="ss">:site_payload</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">site_instance</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">proceed</span><span class="p">,</span> <span class="nb">abort</span><span class="o">|</span>
    <span class="n">monthly_archives</span> <span class="o">=</span> <span class="o">[]</span>

    <span class="n">site_instance</span><span class="o">.</span><span class="n">collated</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">year</span><span class="p">,</span> <span class="nb">hash</span><span class="o">|</span>
      <span class="nb">hash</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">month</span><span class="p">,</span> <span class="n">days</span><span class="o">|</span>
        <span class="n">monthly_archives</span> <span class="o">&lt;&lt;</span> <span class="p">{</span>
          <span class="s1">&#39;name&#39;</span>  <span class="o">=&gt;</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="no">Date</span><span class="o">::</span><span class="no">MONTHNAMES</span><span class="o">[</span><span class="n">month</span><span class="o">]</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="n">year</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
          <span class="s1">&#39;url&#39;</span>   <span class="o">=&gt;</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">year</span><span class="si">}</span><span class="s2">/</span><span class="si">#{</span><span class="n">month</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
          <span class="s1">&#39;posts&#39;</span> <span class="o">=&gt;</span> <span class="n">days</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span>
        <span class="p">}</span>
      <span class="k">end</span>
    <span class="k">end</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">proceed</span><span class="o">.</span><span class="n">call</span>
    <span class="n">result</span><span class="o">[</span><span class="s1">&#39;site&#39;</span><span class="o">][</span><span class="s1">&#39;monthly_archives&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="n">monthly_archives</span>
    <span class="n">result</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

<p>The information for the archive was gathered from the archive_gen extension, although I had to slightly modify. Instead of processing the information after render, I had to do it before rendering, so the information would be available when the pages are created, like this:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span></span><span class="no">AOP</span><span class="o">.</span><span class="n">before</span><span class="p">(</span><span class="no">Site</span><span class="p">,</span> <span class="ss">:render</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">site_instance</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">args</span><span class="o">|</span>
  <span class="n">site_instance</span><span class="o">.</span><span class="n">posts</span><span class="o">.</span><span class="n">reverse</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">post</span><span class="o">|</span>
    <span class="n">y</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">post</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">post</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">post</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">day</span>
    <span class="k">unless</span> <span class="n">site_instance</span><span class="o">.</span><span class="n">collated</span><span class="o">.</span><span class="n">key?</span> <span class="n">y</span>
      <span class="n">site_instance</span><span class="o">.</span><span class="n">collated</span><span class="o">[</span> <span class="n">y</span> <span class="o">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">end</span>
    <span class="k">unless</span> <span class="n">site_instance</span><span class="o">.</span><span class="n">collated</span><span class="o">[</span><span class="n">y</span><span class="o">].</span><span class="n">key?</span> <span class="n">m</span>
      <span class="n">site_instance</span><span class="o">.</span><span class="n">collated</span><span class="o">[</span> <span class="n">y</span> <span class="o">][</span> <span class="n">m</span> <span class="o">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">end</span>
    <span class="k">unless</span> <span class="n">site_instance</span><span class="o">.</span><span class="n">collated</span><span class="o">[</span> <span class="n">y</span> <span class="o">][</span> <span class="n">m</span> <span class="o">].</span><span class="n">key?</span> <span class="n">d</span>
      <span class="n">site_instance</span><span class="o">.</span><span class="n">collated</span><span class="o">[</span> <span class="n">y</span> <span class="o">][</span> <span class="n">m</span> <span class="o">][</span> <span class="n">d</span> <span class="o">]</span> <span class="o">=</span> <span class="o">[]</span>
    <span class="k">end</span>
    <span class="n">site_instance</span><span class="o">.</span><span class="n">collated</span><span class="o">[</span> <span class="n">y</span> <span class="o">][</span> <span class="n">m</span> <span class="o">][</span> <span class="n">d</span> <span class="o">]</span> <span class="o">+=</span> <span class="o">[</span> <span class="n">post</span> <span class="o">]</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

<p>Then inside my layout I was able to easily display this information like this:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span></span><span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
  { % for monthly_archive in site.monthly_archives reversed % }
  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> (0 posts)
  <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
  { % endfor % }
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span></code></pre></figure>

<p>Note the extra space between ‘{‘ and ‘%’, this is to avoid liquid interpreting the code inside the tags. You can view all the source code <a href="http://gist.github.com/324737">here</a>.</p>

    </div>
    <article class=hentry>
      <p class="author vcard">
        By Jorge Dias
        on <time pubdate class=published datetime="2010-03-08T00:00:00+01:00">08 March 2010</time>
      </p>
    </article>
  </div>
</div>
<div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname = 'mrdias';
  (function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

      </div>
      <div id="sidebar" class="one-third column">
        <div class="module">
  <h2>
    Tags
  </h2>
  <div class="cloud-wrap">
    <ul>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/activerecord">
          activerecord
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/ajax">
          ajax
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/archives">
          archives
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.36em" href="https://mrdias.com/tags/automation">
          automation
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.36em" href="https://mrdias.com/tags/awareness">
          awareness
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/aws">
          aws
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/backbone">
          backbone
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.36em" href="https://mrdias.com/tags/capistrano">
          capistrano
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/chef">
          chef
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/conferencia_rails">
          conferencia_rails
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/cucumber">
          cucumber
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/development">
          development
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/devops">
          devops
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.54em" href="https://mrdias.com/tags/docker">
          docker
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.36em" href="https://mrdias.com/tags/emacs">
          emacs
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/emails">
          emails
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/encodings">
          encodings
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/fig">
          fig
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/gardening">
          gardening
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/gdg">
          gdg
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.36em" href="https://mrdias.com/tags/git">
          git
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/IE">
          IE
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.36em" href="https://mrdias.com/tags/javascript">
          javascript
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.36em" href="https://mrdias.com/tags/jekyll">
          jekyll
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/lambda">
          lambda
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/life">
          life
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/marionette">
          marionette
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/merb">
          merb
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.36em" href="https://mrdias.com/tags/migrations">
          migrations
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/open_source">
          open_source
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.36em" href="https://mrdias.com/tags/osx">
          osx
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.36em" href="https://mrdias.com/tags/passenger">
          passenger
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/programming">
          programming
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/prototype">
          prototype
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/python">
          python
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.36em" href="https://mrdias.com/tags/rails">
          rails
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/refactoring">
          refactoring
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.9em" href="https://mrdias.com/tags/reflections">
          reflections
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/ruby">
          ruby
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/rvm">
          rvm
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/shell">
          shell
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/slides">
          slides
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/systems">
          systems
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.18em" href="https://mrdias.com/tags/thor">
          thor
        </a>
      </li>
      
      <li>
        <a style="font-size: 1.36em" href="https://mrdias.com/tags/will_paginate">
          will_paginate
        </a>
      </li>
      
    </ul>
  </div>
</div>
<div class="module">
  <h2>
    Friend's Links
  </h2>
  <ul>
    <li>
      <a href="http://least-significant-bit.com">Least Significant Bit</a>
    </li>
    <li>
      <a href="https://travelswithmyfork.blogspot.com">Travels with my fork</a>
    </li>
  </ul>
</div>
<div class="module">
  <h2>
    Subscribe
  </h2>
  <ul>
    <li>
      <a href="https://feeds2.feedburner.com/mrdias" class="feed-link">RSS</a>
    </li>
  </ul>
</div>
<div class="module">
  <h2>
    Monthly Archives
  </h2>
  <ul>
    
    <li>
      <a href="/2017/03">March 2017</a> (1 posts)
    </li>
    
    <li>
      <a href="/2015/03">March 2015</a> (1 posts)
    </li>
    
    <li>
      <a href="/2014/12">December 2014</a> (2 posts)
    </li>
    
    <li>
      <a href="/2014/07">July 2014</a> (1 posts)
    </li>
    
    <li>
      <a href="/2013/10">October 2013</a> (1 posts)
    </li>
    
    <li>
      <a href="/2012/09">September 2012</a> (1 posts)
    </li>
    
    <li>
      <a href="/2012/07">July 2012</a> (1 posts)
    </li>
    
    <li>
      <a href="/2012/05">May 2012</a> (1 posts)
    </li>
    
    <li>
      <a href="/2012/02">February 2012</a> (1 posts)
    </li>
    
    <li>
      <a href="/2011/12">December 2011</a> (1 posts)
    </li>
    
    <li>
      <a href="/2011/08">August 2011</a> (1 posts)
    </li>
    
    <li>
      <a href="/2011/01">January 2011</a> (1 posts)
    </li>
    
    <li>
      <a href="/2010/11">November 2010</a> (2 posts)
    </li>
    
    <li>
      <a href="/2010/05">May 2010</a> (1 posts)
    </li>
    
    <li>
      <a href="/2010/04">April 2010</a> (1 posts)
    </li>
    
    <li>
      <a href="/2010/03">March 2010</a> (3 posts)
    </li>
    
    <li>
      <a href="/2010/02">February 2010</a> (1 posts)
    </li>
    
    <li>
      <a href="/2009/08">August 2009</a> (1 posts)
    </li>
    
    <li>
      <a href="/2009/02">February 2009</a> (1 posts)
    </li>
    
    <li>
      <a href="/2008/12">December 2008</a> (2 posts)
    </li>
    
  </ul>
</div>
<div class="module">
  <h2>Github</h2>
  <h4>Last Active Repos</h4>
  <ul id="gh_repos">
  </ul>
  <script>
   var github = {
     success: function(response) {
       var repos = [];
       var length = response.data.length >= 10 ? 10: response.data.length
       for (var i = 0; i < length; i++) {
         repos.push(response.data[i]);
       }
       github.render(repos);
     },
     render: function(repos) {
       var i = 0,
       fragment = '',
       target = 'gh_repos';
       t = document.getElementById(target);

       for (i = 0; i < repos.length; i++) {
         fragment += '<li><a href="' + repos[i].html_url + '">' + repos[i].name + '</a><p>' + (repos[i].description || '') + '</p></li>';
       }
       t.innerHTML = fragment;
     }
   }
  </script>
  <script src="https://api.github.com/users/diasjorge/repos?sort=pushed&type=public&callback=github.success"></script>
</div>
<div class="module">
  <h2>Twitter</h2>
  <h4>Recent Activity</h4>
  <a class="twitter-timeline" href="https://twitter.com/dias_jorge" data-widget-id="398762448485744640" data-theme="light" data-chrome="noheader nofooter noscrollbar transparent" data-border-color="#D0D0D0" data-tweet-limit="5"></a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</div>

      </div>
      <div id="footer" class="sixteen columns">
        &copy; 2008-2017 Jorge Dias
      </div>
      <script type="text/javascript">
  //<![CDATA[
    (function() {
        var links = document.getElementsByTagName('a');
        var query = '?';
        for(var i = 0; i < links.length; i++) {
          if(links[i].href.indexOf('#disqus_thread') >= 0) {
            query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
          }
        }
        document.write('<script type="text/javascript" src="https://disqus.com/forums/mrdias/get_num_replies.js' + query + '"></' + 'script>');
    })();
    //]]>
</script>

      <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#f2f1ec"
    },
    "button": {
      "background": "#8ec760",
      "text": "#ffffff"
    }
  },
  "theme": "edgeless"
})});
</script>

    </div>
  </body>
</html>
